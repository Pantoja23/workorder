<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Pantoja Tile | Master Admin</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
:root{
    --primary:#6366f1; --primary-dark:#4f46e5;
    --bg:#070b14; --card:rgba(30,41,59,0.7);
    --text:#f8fafc; --accent:#22c55e;
    --warning:#f59e0b; --danger:#ef4444;
    --stop-blue:#00d2ff;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
body{
    font-family:'Inter',sans-serif;
    margin:0; padding:0; background: var(--bg);
    color:var(--text);
    background-image: radial-gradient(circle at top right, #1e1b4b, #070b14);
    background-attachment: fixed;
}
.container{max-width:1100px;margin:auto;padding:10px 15px 50px;}
header{text-align:center;margin:15px 0;}
header h2{font-size:1.8rem;letter-spacing:3px;font-weight:800;}
header img{height:40px;margin-right:10px;vertical-align:middle;}
.section-title{font-weight:800;font-size:0.75rem;color:var(--primary);margin:15px 0 10px;border-left:4px solid var(--primary);padding-left:12px;display:flex;justify-content:space-between;align-items:center;}
.card{background:var(--card);padding:15px;border-radius:20px;border:1px solid rgba(255,255,255,0.08);backdrop-filter:blur(16px);box-shadow:0 10px 30px rgba(0,0,0,0.5);}
.grid{display:grid;grid-template-columns:1fr;gap:10px;}
@media(min-width:600px){.grid{grid-template-columns:repeat(2,1fr);}.full{grid-column:span 2;}}
input,select,textarea{width:100%;padding:12px;border-radius:12px;border:1px solid #334155;background:rgba(15,23,42,0.8);color:white;font-size:14px;transition:0.3s;}
input:focus,select:focus,textarea:focus{border-color:var(--primary);outline:none;box-shadow:0 0 0 3px rgba(99,102,241,0.2);}
textarea{resize:none;height:80px;}
label{font-size:11px;font-weight:600;color:#94a3b8;margin-bottom:5px;display:block;}
.table-container{background:var(--card);border-radius:16px;border:1px solid rgba(255,255,255,0.08);overflow-x:auto;margin-top:10px;}
table{width:100%;border-collapse:collapse;min-width:600px;}
th{background:rgba(0,0,0,0.3);padding:12px;text-align:left;font-size:11px;color:#94a3b8;text-transform:uppercase;}
td{padding:12px;border-top:1px solid rgba(255,255,255,0.05);}
.btn{padding:12px 16px;border-radius:12px;border:none;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:0.3s;font-size:13px;}
.btn:active{transform:scale(0.95);}
.btn-save{background:var(--primary);color:white;width:100%;justify-content:center;margin-top:10px;font-size:16px;padding:14px;}
.btn-pay-global{background:var(--warning);color:#000;box-shadow:0 4px 15px rgba(245,158,11,0.4);}
.btn-finish{background:transparent;border:1px solid var(--danger);color:var(--danger);}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:9999;align-items:center;justify-content:center;backdrop-filter:blur(5px);padding:15px;}
.pay-modal-content{width:100%;max-width:450px;background:#1e293b;border:1px solid rgba(255,255,255,0.1);padding:25px;border-radius:24px;box-shadow:0 20px 50px -12px rgba(0,0,0,0.5);}
.search-box{position:relative;margin-bottom:15px;}
.search-box input{padding-left:40px;background:var(--card);border:1px solid rgba(99,102,241,0.3);}
.search-box i{position:absolute;left:15px;top:14px;color:var(--primary);font-size:16px;}
.staff-tag{padding:8px 12px;border-radius:12px;font-size:12px;margin:5px 2px;display:inline-flex;flex-direction:column;gap:4px;font-weight:700;cursor:pointer;transition:0.3s;border:2px solid transparent;min-width:120px;}
.gps-cerca{background:rgba(34,197,94,0.15);border-color:var(--accent);color:var(--accent);}
.gps-lejos{background:rgba(239,68,68,0.2);border-color:var(--danger);color:var(--danger);animation:pulse-gps-danger 2s infinite;}
.gps-offline{background:rgba(0,210,255,0.1);border-color:var(--stop-blue);color:var(--stop-blue);}
@keyframes pulse-gps-danger{0%{box-shadow:0 0 0 0px rgba(239,68,68,0.4);}70%{box-shadow:0 0 0 10px rgba(239,68,68,0);}100%{box-shadow:0 0 0 0px rgba(239,68,68,0);}}
.profit-badge{background:rgba(34,197,94,0.1);color:var(--accent);padding:4px 8px;border-radius:6px;font-weight:800;font-size:12px;display:inline-block;margin-top:5px;}
.budget-alert{background:var(--danger);color:white;padding:2px 6px;border-radius:4px;font-weight:800;font-size:9px;display:inline-block;margin-top:5px;animation:pulse 1.5s infinite;}
@keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.05);}100%{transform:scale(1);}}
#timer-display{font-size:10px;color:var(--primary);font-weight:800;margin-left:10px;}
</style>
</head>
<body>
<div class="container">
<header>
    <img src="img/logo.png" alt="Logo"><h2 style="display:inline;">PANTOJA <span style="color:var(--primary)">TILE</span></h2>
    <p style="font-size:11px;color:#94a3b8;font-weight:600;">PORTAL DE ADMINISTRACIÓN <span id="timer-display"></span></p>
</header>

<div id="critical-alerts-panel" style="display:none;margin:10px 0;padding:10px;background:rgba(239,68,68,0.15);border-radius:12px;border-left:5px solid var(--danger);">
    <div id="alerts-container" style="display:flex;flex-direction:column;gap:6px;"></div>
</div>

<div class="section-title">Nueva Orden de Trabajo</div>
<div class="card">
    <div class="grid">
        <div>
            <label>ID WO</label>
            <input type="text" id="id_orden" readonly style="color:var(--warning); font-weight:800; background: rgba(0,0,0,0.3);">
        </div>
        <div>
            <label>Presupuesto ($)</label>
            <input type="number" id="presupuesto" placeholder="Ej: 2500.00">
        </div>
        <div>
            <label>Cliente</label>
            <select id="select_cliente" onchange="autoFillCliente()"></select>
        </div>
        <div>
            <label>Staff Inicial</label>
            <select id="select_worker" onchange="autoFillWorker()"></select>
        </div>
        <div class="full">
            <label>Dirección</label>
            <input type="text" id="direccion" placeholder="Calle, Ciudad, Zip Code">
        </div>
        <div class="full">
            <label>Notas / Instrucciones</label>
            <textarea id="notas" placeholder="Detalles para el staff..."></textarea>
        </div>
    </div>
    <button class="btn btn-save" onclick="guardarOrden()"><i class="fas fa-rocket"></i> LANZAR PROYECTO</button>
</div>

<div class="section-title">
    Proyectos en Curso
    <button class="btn btn-pay-global" onclick="abrirModalNominaGlobal()"><i class="fas fa-dollar-sign"></i> CORTAR NÓMINA</button>
</div>

<div class="search-box">
    <i class="fas fa-search"></i>
    <input type="text" id="busqueda" placeholder="Filtrar por ID, Cliente o Trabajador..." onkeyup="filtrarTabla()">
</div>

<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>Proyecto / Info</th>
                <th>Equipo (GPS Status)</th>
                <th>Rentabilidad</th>
                <th>Gestión</th>
            </tr>
        </thead>
        <tbody id="lista_trabajos"></tbody>
    </table>
</div>

<!-- MODALES -->
<div id="modalAddWorker" class="modal">
    <div class="pay-modal-content" style="border-top:5px solid var(--primary);">
        <h3 style="margin:0 0 10px;color:var(--primary);">Añadir Refuerzo</h3>
        <input type="hidden" id="add_worker_id">
        <div style="margin-bottom:15px;">
            <label>Trabajador Disponible:</label>
            <select id="select_extra_worker"></select>
        </div>
        <div style="display:flex;gap:10px;">
            <button class="btn" style="flex:2;background:var(--primary);color:white;justify-content:center;" onclick="ejecutarAddWorker()">ASIGNAR AHORA</button>
            <button class="btn" style="flex:1;background:#334155;color:white;justify-content:center;" onclick="cerrarModales()">SALIR</button>
        </div>
    </div>
</div>

<div id="modalSelectPay" class="modal">
    <div class="pay-modal-content" style="border-top:5px solid var(--warning);">
        <h3 style="margin:0 0 10px;color:var(--warning);">Corte de Nómina</h3>
        <div style="display:flex;gap:10px;margin-bottom:15px;">
            <div style="flex:1"><label>Desde:</label><input type="date" id="pay_date_from"></div>
            <div style="flex:1"><label>Hasta:</label><input type="date" id="pay_date_to"></div>
        </div>
        <div style="margin-bottom:15px;">
            <label>Filtrar Personal:</label>
            <select id="pay_select_worker"></select>
        </div>
        <div style="display:flex;gap:10px;">
            <button class="btn btn-pay-global" style="flex:2;justify-content:center;padding:16px;" onclick="ejecutarImpresionNomina()">GENERAR Y NOTIFICAR</button>
            <button class="btn" style="flex:1;background:#334155;color:white;justify-content:center;" onclick="cerrarModales()">CANCELAR</button>
        </div>
    </div>
</div>

<script src="admin_demo.js"></script>
</body>
</html>
